<?php

namespace Database\Factories;

use App\Models\Deal;
use App\Models\Company;
use App\Models\Contact;
use App\Models\Stage;
use Illuminate\Database\Eloquent\Factories\Factory;

class DealFactory extends Factory
{
    protected $model = Deal::class;

    public function definition(): array
    {
        $stages = Stage::all();
        return [
            'company_id' => Company::factory(),
            'contact_id' => Contact::factory(),
            'stage_id' => $stages->isNotEmpty() ? $stages->random()->id : null,
            'title' => $this->faker->randomElement([
                'Поставка оборудования', 'Разработка сайта', 'Консалтинговые услуги', 'Рекламная кампания',
                'Обслуживание техники', 'Обучение персонала', 'Внедрение системы', 'Маркетинговое исследование',
                'Дизайн проект', 'Техническая поддержка', 'Аудит компании', 'Юридические услуги'
            ]),
            'amount' => $this->faker->numberBetween(10000, 5000000),
            'currency' => 'RUB',
            'expected_close_date' => $this->faker->dateTimeBetween('now', '+90 days'),
            'description' => $this->faker->randomElement([
                'Крупная сделка по поставке оборудования для производственного предприятия. Требуется согласование технических характеристик и условий поставки.',
                'Разработка корпоративного сайта с интеграцией CRM системы. Проект включает дизайн, верстку и программирование.',
                'Консалтинговые услуги по оптимизации бизнес-процессов. Необходимо провести аудит текущих процессов и предложить улучшения.',
                'Рекламная кампания в социальных сетях и на телевидении. Бюджет рассчитан на 3 месяца активной рекламы.',
                'Обслуживание и ремонт офисной техники. Годовой договор на техническое обслуживание.',
                'Обучение персонала работе с новой системой учета. Планируется провести 5 тренингов по 8 часов.',
                'Внедрение системы автоматизации документооборота. Проект включает установку, настройку и обучение сотрудников.',
                'Маркетинговое исследование рынка конкурентов. Анализ ценовой политики и позиционирования брендов.',
                'Разработка дизайн-проекта офисного помещения. Включает планировку, выбор материалов и мебели.',
                'Техническая поддержка IT-инфраструктуры компании. Круглосуточная поддержка и мониторинг систем.',
                'Проведение финансового аудита компании. Полный анализ финансовой отчетности за последние 3 года.',
                'Юридическое сопровождение сделок и консультации. Помощь в оформлении договоров и разрешении споров.'
            ]),
        ];
    }
}
